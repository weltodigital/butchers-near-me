const { createClient } = require('@supabase/supabase-js')
require('dotenv').config({ path: '.env.local' })

const supabaseUrl = process.env.SUPABASE_URL || process.env.NEXT_PUBLIC_SUPABASE_URL
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY
const supabase = createClient(supabaseUrl, supabaseServiceKey)

// Comprehensive UK city to county mapping
const cityToCountyMapping = {
  // Bedfordshire
  'Bedford': 'Bedfordshire',
  'Biggleswade': 'Bedfordshire',
  'Dunstable': 'Bedfordshire',
  'Leighton Buzzard': 'Bedfordshire',
  'Luton': 'Bedfordshire',

  // West Midlands
  'Stourbridge': 'West Midlands',
  'Brierley Hill': 'West Midlands',
  'Dudley': 'West Midlands',
  'West Bromwich': 'West Midlands',
  'Walsall': 'West Midlands',
  'Oldbury': 'West Midlands',
  'Smethwick': 'West Midlands',
  'Rowley Regis': 'West Midlands',
  'Tipton': 'West Midlands',
  'Wednesbury': 'West Midlands',
  'Bilston': 'West Midlands',
  'Willenhall': 'West Midlands',
  'Darlaston': 'West Midlands',
  'Bloxwich': 'West Midlands',
  'Aldridge': 'West Midlands',
  'Brownhills': 'West Midlands',
  'Pelsall': 'West Midlands',

  // West Sussex
  'Bognor Regis': 'West Sussex',
  'Littlehampton': 'West Sussex',
  'Chichester': 'West Sussex',
  'Worthing': 'West Sussex',
  'Horsham': 'West Sussex',
  'Crawley': 'West Sussex',
  'Haywards Heath': 'West Sussex',
  'East Grinstead': 'West Sussex',
  'Burgess Hill': 'West Sussex',
  'Shoreham-by-Sea': 'West Sussex',
  'Steyning': 'West Sussex',
  'Storrington': 'West Sussex',
  'Pulborough': 'West Sussex',
  'Billingshurst': 'West Sussex',
  'Petworth': 'West Sussex',
  'Midhurst': 'West Sussex',
  'Selsey': 'West Sussex',
  'Arundel': 'West Sussex',

  // Hampshire
  'Fareham': 'Hampshire',
  'Eastleigh': 'Hampshire',
  'Fordingbridge': 'Hampshire',
  'Lymington': 'Hampshire',
  'Romsey': 'Hampshire',
  'Andover': 'Hampshire',
  'Southsea': 'Hampshire',
  'Alresford': 'Hampshire',
  'Alton': 'Hampshire',
  'Emsworth': 'Hampshire',
  'Hayling Island': 'Hampshire',
  'Petersfield': 'Hampshire',
  'Waterlooville': 'Hampshire',
  'Gosport': 'Hampshire',
  'Fleet': 'Hampshire',
  'Farnborough': 'Hampshire',
  'Basingstoke': 'Hampshire',
  'Winchester': 'Hampshire',
  'Southampton': 'Hampshire',
  'Portsmouth': 'Hampshire',
  'New Milton': 'Hampshire',
  'Ringwood': 'Hampshire',
  'Totton': 'Hampshire',
  'Hedge End': 'Hampshire',
  'Fair Oak': 'Hampshire',
  'Whiteley': 'Hampshire',
  'Wickham': 'Hampshire',
  'Botley': 'Hampshire',
  'Swanmore': 'Hampshire',
  'Bishop\'s Waltham': 'Hampshire',
  'Droxford': 'Hampshire',
  'New Alresford': 'Hampshire',
  'Old Alresford': 'Hampshire',
  'Four Marks': 'Hampshire',
  'Medstead': 'Hampshire',
  'Chawton': 'Hampshire',
  'Selborne': 'Hampshire',
  'Liss': 'Hampshire',
  'Bordon': 'Hampshire',
  'Whitehill': 'Hampshire',
  'Grayshott': 'Hampshire',
  'Hindhead': 'Hampshire',
  'Bramshott': 'Hampshire',
  'Liphook': 'Hampshire',
  'Greatham': 'Hampshire',
  'Horndean': 'Hampshire',
  'Clanfield': 'Hampshire',
  'Catherington': 'Hampshire',
  'Cowplain': 'Hampshire',
  'Denmead': 'Hampshire',
  'Purbrook': 'Hampshire',
  'Hambledon': 'Hampshire',
  'Soberton': 'Hampshire',
  'Meonstoke': 'Hampshire',
  'Exton': 'Hampshire',
  'Warnford': 'Hampshire',
  'West Meon': 'Hampshire',
  'East Meon': 'Hampshire',
  'Steep': 'Hampshire',
  'Stroud': 'Hampshire',
  'Sheet': 'Hampshire',
  'Rogate': 'Hampshire',

  // Somerset
  'Bridgwater': 'Somerset',
  'Taunton': 'Somerset',
  'Yeovil': 'Somerset',
  'Burnham-on-Sea': 'Somerset',
  'Clevedon': 'Somerset',
  'Nailsea': 'Somerset',
  'Portishead': 'Somerset',
  'Weston-super-Mare': 'Somerset',
  'Frome': 'Somerset',
  'Chard': 'Somerset',
  'Crewkerne': 'Somerset',
  'Ilminster': 'Somerset',
  'Langport': 'Somerset',
  'Martock': 'Somerset',
  'Somerton': 'Somerset',
  'Street': 'Somerset',
  'Glastonbury': 'Somerset',
  'Wells': 'Somerset',
  'Axbridge': 'Somerset',
  'Cheddar': 'Somerset',
  'Wedmore': 'Somerset',
  'Burnham-on-Sea': 'Somerset',
  'Highbridge': 'Somerset',
  'Minehead': 'Somerset',
  'Watchet': 'Somerset',
  'Williton': 'Somerset',
  'Dulverton': 'Somerset',
  'Exford': 'Somerset',
  'Porlock': 'Somerset',

  // Kent
  'Deal': 'Kent',
  'Dover': 'Kent',
  'Margate': 'Kent',
  'Ramsgate': 'Kent',
  'Birchington': 'Kent',
  'Broadstairs': 'Kent',
  'Sandwich': 'Kent',
  'Canterbury': 'Kent',
  'Folkestone': 'Kent',
  'Ashford': 'Kent',
  'Maidstone': 'Kent',
  'Tonbridge': 'Kent',
  'Tunbridge Wells': 'Kent',
  'Sevenoaks': 'Kent',
  'Dartford': 'Kent',
  'Gravesend': 'Kent',
  'Chatham': 'Kent',
  'Gillingham': 'Kent',
  'Rochester': 'Kent',
  'Sittingbourne': 'Kent',
  'Faversham': 'Kent',
  'Whitstable': 'Kent',
  'Herne Bay': 'Kent',
  'Thanet': 'Kent',
  'Swale': 'Kent',
  'Medway': 'Kent',
  'Sheerness': 'Kent',
  'Minster': 'Kent',
  'Queenborough': 'Kent',
  'Iwade': 'Kent',
  'Newington': 'Kent',
  'Rainham': 'Kent',
  'Upchurch': 'Kent',
  'Hartlip': 'Kent',
  'Stockbury': 'Kent',
  'Bredgar': 'Kent',
  'Milstead': 'Kent',
  'Rodmersham': 'Kent',
  'Lynsted': 'Kent',
  'Kingsdown': 'Kent',
  'Eastry': 'Kent',
  'Woodnesborough': 'Kent',
  'Ash': 'Kent',
  'Wingham': 'Kent',
  'Goodnestone': 'Kent',
  'Nonington': 'Kent',
  'Aylesham': 'Kent',
  'Snowdown': 'Kent',
  'Elvington': 'Kent',
  'Eythorne': 'Kent',
  'Shepherdswell': 'Kent',
  'Coldred': 'Kent',
  'Guston': 'Kent',
  'Whitfield': 'Kent',
  'Temple Ewell': 'Kent',
  'River': 'Kent',
  'Kearsney': 'Kent',
  'Lydden': 'Kent',
  'Napchester': 'Kent',
  'Martin': 'Kent',
  'Sutton': 'Kent',
  'Ripple': 'Kent',
  'Tilmanstone': 'Kent',
  'Betteshanger': 'Kent',
  'Sholden': 'Kent',
  'Great Mongeham': 'Kent',
  'Ringwould': 'Kent',
  'Walmer': 'Kent',
  'Kingsdown': 'Kent',
  'St Margaret\'s at Cliffe': 'Kent',

  // Dorset
  'Poole': 'Dorset',
  'Wimborne': 'Dorset',
  'Christchurch': 'Dorset',
  'Ferndown': 'Dorset',
  'Blandford Forum': 'Dorset',
  'Shaftesbury': 'Dorset',
  'Wareham': 'Dorset',
  'Weymouth': 'Dorset',
  'Bournemouth': 'Dorset',
  'Dorchester': 'Dorset',
  'Bridport': 'Dorset',
  'Lyme Regis': 'Dorset',
  'Beaminster': 'Dorset',
  'Sherborne': 'Dorset',
  'Gillingham': 'Dorset',
  'Sturminster Newton': 'Dorset',
  'Blandford': 'Dorset',
  'Verwood': 'Dorset',
  'Swanage': 'Dorset',
  'Corfe Castle': 'Dorset',
  'Wool': 'Dorset',
  'Bovington': 'Dorset',
  'Winfrith Newburgh': 'Dorset',
  'Moreton': 'Dorset',
  'Crossways': 'Dorset',
  'Broadmayne': 'Dorset',
  'Osmington': 'Dorset',
  'Preston': 'Dorset',
  'Sutton Poyntz': 'Dorset',
  'Radipole': 'Dorset',
  'Melcombe Regis': 'Dorset',
  'Upwey': 'Dorset',
  'Broadwey': 'Dorset',
  'Chickerell': 'Dorset',
  'Wyke Regis': 'Dorset',
  'Portland': 'Dorset',
  'Fortuneswell': 'Dorset',
  'Easton': 'Dorset',
  'Weston': 'Dorset',
  'Southwell': 'Dorset',

  // Isle of Wight
  'Ryde': 'Isle of Wight',
  'Newport': 'Isle of Wight',
  'Cowes': 'Isle of Wight',
  'Sandown': 'Isle of Wight',
  'Shanklin': 'Isle of Wight',
  'Ventnor': 'Isle of Wight',
  'Freshwater': 'Isle of Wight',
  'Yarmouth': 'Isle of Wight',
  'Bembridge': 'Isle of Wight',
  'Seaview': 'Isle of Wight',
  'St Helens': 'Isle of Wight',
  'Brading': 'Isle of Wight',
  'Lake': 'Isle of Wight',
  'Niton': 'Isle of Wight',
  'Godshill': 'Isle of Wight',
  'Wroxall': 'Isle of Wight',
  'Chale': 'Isle of Wight',
  'Brighstone': 'Isle of Wight',
  'Calbourne': 'Isle of Wight',
  'Shorwell': 'Isle of Wight',
  'Carisbrooke': 'Isle of Wight',
  'Parkhurst': 'Isle of Wight',
  'Northwood': 'Isle of Wight',
  'Gurnard': 'Isle of Wight',
  'Whippingham': 'Isle of Wight',
  'Fishbourne': 'Isle of Wight',
  'Wootton Bridge': 'Isle of Wight',
  'Havenstreet': 'Isle of Wight',
  'Ashey': 'Isle of Wight',
  'Newchurch': 'Isle of Wight',
  'Alverstone': 'Isle of Wight',
  'Queen\'s Bower': 'Isle of Wight',
  'Apse Heath': 'Isle of Wight',
  'Winford': 'Isle of Wight',
  'Whiteley Bank': 'Isle of Wight',
  'Merstone': 'Isle of Wight',
  'Blackwater': 'Isle of Wight',
  'Rookley': 'Isle of Wight',
  'Chillerton': 'Isle of Wight',
  'Gatcombe': 'Isle of Wight',

  // Scotland - Highland
  'Stornoway': 'Highland',
  'Thurso': 'Highland',
  'Wick': 'Highland',
  'Dingwall': 'Highland',
  'Invergordon': 'Highland',
  'Tain': 'Highland',
  'Golspie': 'Highland',
  'Brora': 'Highland',
  'Helmsdale': 'Highland',
  'Lybster': 'Highland',
  'Dunbeath': 'Highland',
  'Halkirk': 'Highland',
  'Castletown': 'Highland',
  'Scrabster': 'Highland',
  'John o\' Groats': 'Highland',
  'Tongue': 'Highland',
  'Bettyhill': 'Highland',
  'Altnaharra': 'Highland',
  'Lairg': 'Highland',
  'Bonar Bridge': 'Highland',
  'Ardgay': 'Highland',
  'Spinningdale': 'Highland',
  'Edderton': 'Highland',
  'Balintore': 'Highland',
  'Hilton': 'Highland',
  'Nigg': 'Highland',
  'Portmahomack': 'Highland',
  'Inver': 'Highland',
  'Fearn': 'Highland',
  'Hill of Fearn': 'Highland',
  'Kildary': 'Highland',
  'Barbaraville': 'Highland',
  'Delny': 'Highland',
  'Kincardine': 'Highland',
  'Ankerville Corner': 'Highland',
  'Scotsburn': 'Highland',
  'Culbokie': 'Highland',
  'Jemimaville': 'Highland',
  'Cromarty': 'Highland',
  'Rosemarkie': 'Highland',
  'Fortrose': 'Highland',
  'Avoch': 'Highland',
  'Munlochy': 'Highland',
  'North Kessock': 'Highland',
  'Charleston': 'Highland',
  'Inverness': 'Highland',
  'Beauly': 'Highland',
  'Muir of Ord': 'Highland',
  'Conon Bridge': 'Highland',
  'Maryburgh': 'Highland',
  'Strathpeffer': 'Highland',
  'Garve': 'Highland',
  'Achnasheen': 'Highland',
  'Kinlochewe': 'Highland',
  'Torridon': 'Highland',
  'Shieldaig': 'Highland',
  'Applecross': 'Highland',
  'Lochcarron': 'Highland',
  'Stromeferry': 'Highland',
  'Plockton': 'Highland',
  'Kyle of Lochalsh': 'Highland',
  'Dornie': 'Highland',
  'Ardelve': 'Highland',
  'Ratagan': 'Highland',
  'Shiel Bridge': 'Highland',
  'Invergarry': 'Highland',
  'Fort Augustus': 'Highland',
  'Drumnadrochit': 'Highland',
  'Cannich': 'Highland',
  'Tomich': 'Highland',
  'Glen Affric': 'Highland',
  'Kiltarlity': 'Highland',
  'Eskadale': 'Highland',
  'Kirkhill': 'Highland',
  'Balblair': 'Highland',
  'Clachnaharry': 'Highland',
  'Smithton': 'Highland',
  'Culloden': 'Highland',
  'Balloch': 'Highland',
  'Daviot': 'Highland',
  'Moy': 'Highland',
  'Tomatin': 'Highland',
  'Carrbridge': 'Highland',
  'Boat of Garten': 'Highland',
  'Aviemore': 'Highland',
  'Coylumbridge': 'Highland',
  'Rothiemurchus': 'Highland',
  'Glenmore': 'Highland',
  'Nethy Bridge': 'Highland',
  'Grantown-on-Spey': 'Highland',
  'Cromdale': 'Highland',
  'Advie': 'Highland',
  'Knockando': 'Highland',
  'Archiestown': 'Highland',
  'Craigellachie': 'Highland',
  'Aberlour': 'Highland',
  'Charlestown of Aberlour': 'Highland',
  'Marypark': 'Highland',
  'Carron': 'Highland',
  'Laggan': 'Highland',
  'Newtonmore': 'Highland',
  'Kingussie': 'Highland',
  'Insh': 'Highland',
  'Kincraig': 'Highland',
  'Alvie': 'Highland',
  'Dalwhinnie': 'Highland',
  'Fort William': 'Highland',
  'Spean Bridge': 'Highland',
  'Roy Bridge': 'Highland',
  'Tulloch': 'Highland',
  'Rannoch Station': 'Highland',
  'Corrour': 'Highland',
  'Glenfinnan': 'Highland',
  'Lochailort': 'Highland',
  'Beasdale': 'Highland',
  'Arisaig': 'Highland',
  'Morar': 'Highland',
  'Mallaig': 'Highland',
  'Knoydart': 'Highland',
  'Inverie': 'Highland',
  'Tarbet': 'Highland',
  'Kinloch Hourn': 'Highland',

  // Scotland - Orkney
  'Kirkwall': 'Orkney',
  'Stromness': 'Orkney',
  'Finstown': 'Orkney',
  'Dounby': 'Orkney',
  'Evie': 'Orkney',
  'Rendall': 'Orkney',
  'Tingwall': 'Orkney',
  'St Margaret\'s Hope': 'Orkney',
  'Burray': 'Orkney',
  'South Ronaldsay': 'Orkney',
  'Flotta': 'Orkney',
  'Hoy': 'Orkney',
  'Longhope': 'Orkney',
  'Lyness': 'Orkney',
  'Rackwick': 'Orkney',
  'Graemsay': 'Orkney',
  'Shapinsay': 'Orkney',
  'Balfour': 'Orkney',
  'Stronsay': 'Orkney',
  'Whitehall': 'Orkney',
  'Sanday': 'Orkney',
  'Lady': 'Orkney',
  'Kettletoft': 'Orkney',
  'Westray': 'Orkney',
  'Pierowall': 'Orkney',
  'Papa Westray': 'Orkney',
  'North Ronaldsay': 'Orkney',
  'Eday': 'Orkney',
  'London': 'Orkney',
  'Rousay': 'Orkney',
  'Sourin': 'Orkney',
  'Wyre': 'Orkney',
  'Egilsay': 'Orkney',

  // Northern Ireland - County Antrim
  'Ballycastle': 'County Antrim',
  'Ballymena': 'County Antrim',
  'Ballymoney': 'County Antrim',
  'Carrickfergus': 'County Antrim',
  'Larne': 'County Antrim',
  'Lisburn': 'County Antrim',
  'Newtownabbey': 'County Antrim',
  'Antrim': 'County Antrim',
  'Crumlin': 'County Antrim',
  'Randalstown': 'County Antrim',
  'Toomebridge': 'County Antrim',
  'Ahoghill': 'County Antrim',
  'Broughshane': 'County Antrim',
  'Cullybackey': 'County Antrim',
  'Kells': 'County Antrim',
  'Portglenone': 'County Antrim',
  'Cloughmills': 'County Antrim',
  'Dervock': 'County Antrim',
  'Dunloy': 'County Antrim',
  'Glarryford': 'County Antrim',
  'Mosside': 'County Antrim',
  'Rasharkin': 'County Antrim',
  'Stranocum': 'County Antrim',
  'Armoy': 'County Antrim',
  'Bushmills': 'County Antrim',
  'Cushendall': 'County Antrim',
  'Cushendun': 'County Antrim',
  'Glenariff': 'County Antrim',
  'Waterfoot': 'County Antrim',
  'Carnlough': 'County Antrim',
  'Glenarm': 'County Antrim',
  'Ballygalley': 'County Antrim',
  'Ballygally': 'County Antrim',
  'Cairncastle': 'County Antrim',
  'Gleno': 'County Antrim',
  'Islandmagee': 'County Antrim',
  'Whitehead': 'County Antrim',
  'Ballynure': 'County Antrim',
  'Ballyrobert': 'County Antrim',
  'Doagh': 'County Antrim',
  'Parkgate': 'County Antrim',
  'Templepatrick': 'County Antrim',
  'Dunadry': 'County Antrim',
  'Aldergrove': 'County Antrim',
  'Muckamore': 'County Antrim',
  'Killead': 'County Antrim',
  'Tardree': 'County Antrim',
  'Straid': 'County Antrim',
  'Glenoe': 'County Antrim',
  'Ballinderry Lower': 'County Antrim',
  'Ballinderry Upper': 'County Antrim',
  'Glenavy': 'County Antrim',
  'Tullyrusk': 'County Antrim',
  'Aghalee': 'County Antrim',
  'Soldierstown': 'County Antrim',
  'Stoneyford': 'County Antrim',
  'Lurgan': 'County Antrim',
  'Portadown': 'County Antrim',
  'Craigavon': 'County Antrim',
  'Moira': 'County Antrim',
  'Maghaberry': 'County Antrim',
  'Hillsborough': 'County Antrim',
  'Dromore': 'County Antrim',
  'Dromara': 'County Antrim',
  'Annahilt': 'County Antrim',
  'Ballynahinch': 'County Antrim',
  'Saintfield': 'County Antrim',
  'Carryduff': 'County Antrim',
  'Dundonald': 'County Antrim',
  'Comber': 'County Antrim',
  'Moneyreagh': 'County Antrim',
  'Crossgar': 'County Antrim',
  'Downpatrick': 'County Antrim',

  // Northern Ireland - County Down
  'Newry': 'County Down',
  'Banbridge': 'County Down',
  'Newcastle': 'County Down',
  'Downpatrick': 'County Down',
  'Ballynahinch': 'County Down',
  'Holywood': 'County Down',
  'Bangor': 'County Down',
  'Newtownards': 'County Down',
  'Donaghadee': 'County Down',
  'Portaferry': 'County Down',
  'Strangford': 'County Down',
  'Ardglass': 'County Down',
  'Killough': 'County Down',
  'Dundrum': 'County Down',
  'Ballykinler': 'County Down',
  'Clough': 'County Down',
  'Seaforde': 'County Down',
  'Lecale': 'County Down',
  'Saul': 'County Down',
  'Raholp': 'County Down',
  'Strangford': 'County Down',
  'Killyleagh': 'County Down',
  'Whiterock': 'County Down',
  'Comber': 'County Down',
  'Killinchy': 'County Down',
  'Mahee Island': 'County Down',
  'Ringneill': 'County Down',
  'Greyabbey': 'County Down',
  'Kircubbin': 'County Down',
  'Cloughey': 'County Down',
  'Ballyhalbert': 'County Down',
  'Ballywalter': 'County Down',
  'Whitehead': 'County Down',
  'Millisle': 'County Down',
  'Ballycopeland': 'County Down',
  'Conlig': 'County Down',
  'Crawfordsburn': 'County Down',
  'Helen\'s Bay': 'County Down',
  'Seahill': 'County Down',
  'Cultra': 'County Down',
  'Craigavad': 'County Down',
  'Knock': 'County Down',
  'Dundonald': 'County Down',
  'Stormont': 'County Down',
  'Gilnahirk': 'County Down',
  'Braniel': 'County Down',
  'Cregagh': 'County Down',
  'Castlereagh': 'County Down',
  'Crossnacreevy': 'County Down',
  'Drumbo': 'County Down',
  'Carryduff': 'County Down',
  'Killyleagh': 'County Down',
  'Saintfield': 'County Down',
  'Crossgar': 'County Down',
  'Toye': 'County Down',
  'Loughinisland': 'County Down',
  'Clough': 'County Down',
  'Drumaness': 'County Down',
  'Ballyward': 'County Down',
  'Castlewellan': 'County Down',
  'Maghera': 'County Down',
  'Bryansford': 'County Down',
  'Tollymore': 'County Down',
  'Annalong': 'County Down',
  'Kilkeel': 'County Down',
  'Greencastle': 'County Down',
  'Cranfield': 'County Down',
  'Rostrevor': 'County Down',
  'Warrenpoint': 'County Down',
  'Omeath': 'County Down',
  'Carlingford': 'County Down',
  'Mayobridge': 'County Down',
  'Rathfriland': 'County Down',
  'Hilltown': 'County Down',
  'Cabra': 'County Down',
  'Legananny': 'County Down',
  'Dromara': 'County Down',
  'Finnis': 'County Down',
  'Annahilt': 'County Down',
  'Magheralin': 'County Down',
  'Dollingstown': 'County Down',
  'Waringstown': 'County Down',
  'Donaghcloney': 'County Down',
  'Gilford': 'County Down',
  'Scarva': 'County Down',
  'Poyntzpass': 'County Down',
  'Acton': 'County Down',
  'Laurelvale': 'County Down',
  'Tandragee': 'County Down',
  'Markethill': 'County Down',
  'Hamilton\'s Bawn': 'County Down',
  'Richhill': 'County Down',
  'Portadown': 'County Down',
  'Craigavon': 'County Down',
  'Lurgan': 'County Down',
  'Aghacommon': 'County Down',
  'Aghagallon': 'County Down',
  'Magheralin': 'County Down',
  'Moira': 'County Down',

  // Wales - Monmouthshire
  'Chepstow': 'Monmouthshire',
  'Abergavenny': 'Monmouthshire',
  'Monmouth': 'Monmouthshire',
  'Caldicot': 'Monmouthshire',
  'Usk': 'Monmouthshire',
  'Raglan': 'Monmouthshire',
  'Tintern': 'Monmouthshire',
  'Mathern': 'Monmouthshire',
  'Portskewett': 'Monmouthshire',
  'Sudbrook': 'Monmouthshire',
  'Caerwent': 'Monmouthshire',
  'Shirenewton': 'Monmouthshire',
  'Devauden': 'Monmouthshire',
  'St Arvans': 'Monmouthshire',
  'Itton': 'Monmouthshire',
  'Tutshill': 'Monmouthshire',
  'Beachley': 'Monmouthshire',
  'Tidenham': 'Monmouthshire',
  'Woolaston': 'Monmouthshire',
  'Alvington': 'Monmouthshire',
  'Aylburton': 'Monmouthshire',
  'Lydney': 'Monmouthshire',
  'Coleford': 'Monmouthshire',
  'Clearwell': 'Monmouthshire',
  'St Briavels': 'Monmouthshire',
  'Hewelsfield': 'Monmouthshire',
  'Brockweir': 'Monmouthshire',
  'Llandogo': 'Monmouthshire',
  'Whitebrook': 'Monmouthshire',
  'Llanishen': 'Monmouthshire',
  'Trellech': 'Monmouthshire',
  'Catbrook': 'Monmouthshire',
  'Penterry': 'Monmouthshire',
  'St Pierre': 'Monmouthshire',
  'Mathern': 'Monmouthshire',
  'Pwllmeyric': 'Monmouthshire',
  'Rogiet': 'Monmouthshire',
  'Undy': 'Monmouthshire',
  'Magor': 'Monmouthshire',
  'Redwick': 'Monmouthshire',
  'Goldcliff': 'Monmouthshire',
  'Nash': 'Monmouthshire',
  'Whitson': 'Monmouthshire',
  'Llanmartin': 'Monmouthshire',
  'Llanfihangel Rogiet': 'Monmouthshire',
  'Llanvair Discoed': 'Monmouthshire',
  'Llangwm': 'Monmouthshire',
  'Llanvaches': 'Monmouthshire',
  'Kemeys Commander': 'Monmouthshire',
  'Kemeys Inferior': 'Monmouthshire',
  'Caerleon': 'Monmouthshire',
  'Llanfrechfa': 'Monmouthshire',
  'Llanhennock': 'Monmouthshire',
  'Llangybi': 'Monmouthshire',
  'Llantarnam': 'Monmouthshire',
  'Cwmbran': 'Monmouthshire',
  'Pontypool': 'Monmouthshire',
  'Griffithstown': 'Monmouthshire',
  'Sebastopol': 'Monmouthshire',
  'New Inn': 'Monmouthshire',
  'Ponthir': 'Monmouthshire',
  'Caerleon': 'Monmouthshire',
  'Christchurch': 'Monmouthshire',
  'Llanwern': 'Monmouthshire',
  'Nash': 'Monmouthshire',
  'Goldcliff': 'Monmouthshire',
  'Redwick': 'Monmouthshire',
  'Whitson': 'Monmouthshire',
  'Llanmartin': 'Monmouthshire',
  'Llanfihangel Rogiet': 'Monmouthshire',
  'Llanvair Discoed': 'Monmouthshire',
  'Llangwm': 'Monmouthshire',
  'Llanvaches': 'Monmouthshire',
  'Kemeys Commander': 'Monmouthshire',
  'Kemeys Inferior': 'Monmouthshire',

  // Wales - Powys
  'Welshpool': 'Powys',
  'Presteigne': 'Powys',
  'Newtown': 'Powys',
  'Llandrindod Wells': 'Powys',
  'Rhayader': 'Powys',
  'Builth Wells': 'Powys',
  'Brecon': 'Powys',
  'Hay-on-Wye': 'Powys',
  'Crickhowell': 'Powys',
  'Talgarth': 'Powys',
  'Llangorse': 'Powys',
  'Sennybridge': 'Powys',
  'Ystradgynlais': 'Powys',
  'Hirwaun': 'Powys',
  'Penderyn': 'Powys',
  'Vaynor': 'Powys',
  'Cefn Coed': 'Powys',
  'Pontsticill': 'Powys',
  'Talybont-on-Usk': 'Powys',
  'Llangynhafal': 'Powys',
  'Bwlch': 'Powys',
  'Llangattock': 'Powys',
  'Gilwern': 'Powys',
  'Clydach': 'Powys',
  'Brynmawr': 'Powys',
  'Beaufort': 'Powys',
  'Ebbw Vale': 'Powys',
  'Tredegar': 'Powys',
  'Rhymney': 'Powys',
  'Abertillery': 'Powys',
  'Blaenavon': 'Powys',
  'Abergavenny': 'Powys',
  'Raglan': 'Powys',
  'Usk': 'Powys',
  'Caerleon': 'Powys',
  'Monmouth': 'Powys',
  'Chepstow': 'Powys',
  'Caldicot': 'Powys',
  'Magor': 'Powys',
  'Undy': 'Powys',
  'Rogiet': 'Powys',
  'Portskewett': 'Powys',
  'Sudbrook': 'Powys',
  'Mathern': 'Powys',
  'Tintern': 'Powys',
  'St Arvans': 'Powys',
  'Devauden': 'Powys',
  'Shirenewton': 'Powys',
  'Caerwent': 'Powys',
  'Llanvair Discoed': 'Powys',
  'Llangwm': 'Powys',
  'Llanvaches': 'Powys',
  'Kemeys Commander': 'Powys',
  'Kemeys Inferior': 'Powys',
  'Llanhennock': 'Powys',
  'Llangybi': 'Powys',
  'Llantarnam': 'Powys',
  'Cwmbran': 'Powys',
  'Pontypool': 'Powys',
  'Abersychan': 'Powys',
  'Talywain': 'Powys',
  'Varteg': 'Powys',
  'New Inn': 'Powys',
  'Ponthir': 'Powys',
  'Griffithstown': 'Powys',
  'Sebastopol': 'Powys',
  'Garndiffaith': 'Powys',
  'Pentwyn': 'Powys',
  'Croesyceiliog': 'Powys',
  'Llanyrafon': 'Powys',
  'Fairwater': 'Powys',
  'Thornhill': 'Powys',
  'Greenmeadow': 'Powys',
  'Hollybush': 'Powys',
  'Upper Cwmbran': 'Powys',
  'Henllys': 'Powys',
  'Two Locks': 'Powys',
  'Oakfield': 'Powys',
  'Coed Eva': 'Powys',
  'Old Cwmbran': 'Powys',
  'St Dials': 'Powys',
  'Llantarnam': 'Powys',
  'Greenforge': 'Powys',
  'Cwmbran Drive': 'Powys',
  'Ty Canol': 'Powys',
  'Woodland Road': 'Powys',
  'Ty Gwyn': 'Powys',
  'Police Station': 'Powys',
  'Southville': 'Powys',
  'Bettws': 'Powys',
  'Rhydyfelin': 'Powys',
  'Church Village': 'Powys',
  'Llantwit Fardre': 'Powys',
  'Tonteg': 'Powys',
  'Llantrisant': 'Powys',
  'Pencoed': 'Powys',
  'Llanharan': 'Powys',
  'Talbot Green': 'Powys',
  'Pontyclun': 'Powys',
  'Groesfaen': 'Powys',
  'Creigiau': 'Powys',
  'Pentyrch': 'Powys',
  'Radyr': 'Powys',
  'Morganstown': 'Powys',
  'Whitchurch': 'Powys',
  'Rhiwbina': 'Powys',
  'Birchgrove': 'Powys',
  'Heath': 'Powys',
  'Cyncoed': 'Powys',
  'Llanedeyrn': 'Powys',
  'Pontprennau': 'Powys',
  'Old St Mellons': 'Powys',
  'St Mellons': 'Powys',
  'Trowbridge': 'Powys',
  'Castleton': 'Powys',
  'Marshfield': 'Powys',
  'Peterstone Wentlooge': 'Powys',
  'Wentlooge': 'Powys',
  'Rumney': 'Powys',
  'Llanrumney': 'Powys',
  'Pentwyn': 'Powys',
  'Llanedeyrn': 'Powys',
  'Cefn Mably': 'Powys',
  'Michaelston-y-Fedw': 'Powys',
  'Rudry': 'Powys',
  'Lisvane': 'Powys',
  'Thornhill': 'Powys',
  'Caerphilly': 'Powys',
  'Aber Valley': 'Powys',
  'Senghenydd': 'Powys',
  'Abertridwr': 'Powys',
  'Bedwas': 'Powys',
  'Trethomas': 'Powys',
  'Machen': 'Powys',
  'Draethen': 'Powys',
  'Waterloo': 'Powys',
  'Crosskeys': 'Powys',
  'Abercarn': 'Powys',
  'Newbridge': 'Powys',
  'Crumlin': 'Powys',
  'Pontywaun': 'Powys',
  'Risca': 'Powys',
  'Pontymister': 'Powys',
  'Rogerstone': 'Powys',
  'Bassaleg': 'Powys',
  'Rhiwderin': 'Powys',
  'Graig': 'Powys',
  'High Cross': 'Powys',
  'Rogerstone': 'Powys',
  'Tredegar Park': 'Powys',
  'Duffryn': 'Powys',
  'Maindee': 'Powys',
  'Pill': 'Powys',
  'Victoria': 'Powys',
  'Commercial Street': 'Powys',
  'Stow Hill': 'Powys',
  'Belle Vue': 'Powys',
  'Corporation Road': 'Powys',
  'Old Green Roundabout': 'Powys',
  'Malpas': 'Powys',
  'Bettws': 'Powys',
  'Ringland': 'Powys',
  'Lliswerry': 'Powys',
  'Somerton': 'Powys',
  'Lawrence Hill': 'Powys',
  'Pill': 'Powys',
  'Underwood': 'Powys',
  'Shaftesbury': 'Powys',
  'Gaer': 'Powys',
  'Allt-yr-yn': 'Powys',
  'Fairoak': 'Powys',
  'Ridgeway': 'Powys',
  'Beechwood': 'Powys',
  'Caerleon': 'Powys',
  'Ponthir': 'Powys',
  'Christchurch': 'Powys',
  'Llanwern': 'Powys',
  'Bishton': 'Powys',
  'Goldcliff': 'Powys',
  'Nash': 'Powys',
  'Redwick': 'Powys',
  'Whitson': 'Powys',
  'Llanmartin': 'Powys',
  'Llanfihangel Rogiet': 'Powys',
  'Llanvair Discoed': 'Powys',
  'Llangwm': 'Powys',
  'Llanvaches': 'Powys',
  'Kemeys Commander': 'Powys',
  'Kemeys Inferior': 'Powys',
  'Llanhennock': 'Powys',
  'Llangybi': 'Powys',

  // Worcestershire
  'Stourport-on-Severn': 'Worcestershire',
  'Kidderminster': 'Worcestershire',
  'Bewdley': 'Worcestershire',
  'Worcester': 'Worcestershire',
  'Droitwich': 'Worcestershire',
  'Evesham': 'Worcestershire',
  'Pershore': 'Worcestershire',
  'Malvern': 'Worcestershire',
  'Upton-upon-Severn': 'Worcestershire',
  'Tenbury Wells': 'Worcestershire',
  'Bromsgrove': 'Worcestershire',
  'Redditch': 'Worcestershire',
  'Studley': 'Worcestershire',
  'Alcester': 'Worcestershire',
  'Inkberrow': 'Worcestershire',
  'Feckenham': 'Worcestershire',
  'Harvington': 'Worcestershire',
  'Salford Priors': 'Worcestershire',
  'Bidford-on-Avon': 'Worcestershire',
  'Honeybourne': 'Worcestershire',
  'Badsey': 'Worcestershire',
  'Bretforton': 'Worcestershire',
  'Offenham': 'Worcestershire',
  'South Littleton': 'Worcestershire',
  'Middle Littleton': 'Worcestershire',
  'North Littleton': 'Worcestershire',
  'Cleeve Prior': 'Worcestershire',
  'Harvington': 'Worcestershire',
  'Norton': 'Worcestershire',
  'Lenchwick': 'Worcestershire',
  'Church Lench': 'Worcestershire',
  'Rous Lench': 'Worcestershire',
  'Sheriff\'s Lench': 'Worcestershire',
  'Radford': 'Worcestershire',
  'Dunnington': 'Worcestershire',
  'Charlton': 'Worcestershire',
  'Cropthorne': 'Worcestershire',
  'Charlton': 'Worcestershire',
  'Fladbury': 'Worcestershire',
  'Pinvin': 'Worcestershire',
  'Throckmorton': 'Worcestershire',
  'Wyre Piddle': 'Worcestershire',
  'Peopleton': 'Worcestershire',
  'White Ladies Aston': 'Worcestershire',
  'Flyford Flavell': 'Worcestershire',
  'Grafton Flyford': 'Worcestershire',
  'North Piddle': 'Worcestershire',
  'Naunton Beauchamp': 'Worcestershire',
  'Drakes Broughton': 'Worcestershire',
  'Wadborough': 'Worcestershire',
  'Pirton': 'Worcestershire',
  'Defford': 'Worcestershire',
  'Besford': 'Worcestershire',
  'Eckington': 'Worcestershire',
  'Birlingham': 'Worcestershire',
  'Great Comberton': 'Worcestershire',
  'Little Comberton': 'Worcestershire',
  'Elmley Castle': 'Worcestershire',
  'Kersoe': 'Worcestershire',
  'Bricklehampton': 'Worcestershire',
  'Netherton': 'Worcestershire',
  'Woollas Hall': 'Worcestershire',
  'Pensham': 'Worcestershire',
  'Wyre Piddle': 'Worcestershire',
  'Abberton': 'Worcestershire',
  'South Littleton': 'Worcestershire',
  'Middle Littleton': 'Worcestershire',
  'North Littleton': 'Worcestershire',
  'Cleeve Prior': 'Worcestershire',
  'Harvington': 'Worcestershire',
  'Norton': 'Worcestershire',
  'Lenchwick': 'Worcestershire',
  'Church Lench': 'Worcestershire',
  'Rous Lench': 'Worcestershire',
  'Sheriff\'s Lench': 'Worcestershire',
  'Radford': 'Worcestershire',
  'Dunnington': 'Worcestershire',
  'Charlton': 'Worcestershire',
  'Cropthorne': 'Worcestershire',
  'Charlton': 'Worcestershire',
  'Fladbury': 'Worcestershire',
  'Pinvin': 'Worcestershire',
  'Throckmorton': 'Worcestershire',
  'Wyre Piddle': 'Worcestershire',
  'Peopleton': 'Worcestershire',
  'White Ladies Aston': 'Worcestershire',
  'Flyford Flavell': 'Worcestershire',
  'Grafton Flyford': 'Worcestershire',
  'North Piddle': 'Worcestershire',
  'Naunton Beauchamp': 'Worcestershire',
  'Drakes Broughton': 'Worcestershire',
  'Wadborough': 'Worcestershire',
  'Pirton': 'Worcestershire',
  'Defford': 'Worcestershire',
  'Besford': 'Worcestershire',
  'Eckington': 'Worcestershire',
  'Birlingham': 'Worcestershire',
  'Great Comberton': 'Worcestershire',
  'Little Comberton': 'Worcestershire',
  'Elmley Castle': 'Worcestershire',
  'Kersoe': 'Worcestershire',
  'Bricklehampton': 'Worcestershire',
  'Netherton': 'Worcestershire',
  'Woollas Hall': 'Worcestershire',
  'Pensham': 'Worcestershire',

  // Surrey
  'Godalming': 'Surrey',
  'Guildford': 'Surrey',
  'Farnham': 'Surrey',
  'Camberley': 'Surrey',
  'Woking': 'Surrey',
  'Dorking': 'Surrey',
  'Leatherhead': 'Surrey',
  'Epsom': 'Surrey',
  'Reigate': 'Surrey',
  'Redhill': 'Surrey',
  'Caterham': 'Surrey',
  'Weybridge': 'Surrey',
  'Walton-on-Thames': 'Surrey',
  'Esher': 'Surrey',
  'Kingston upon Thames': 'Surrey',
  'Surbiton': 'Surrey',
  'New Malden': 'Surrey',
  'Raynes Park': 'Surrey',
  'Wimbledon': 'Surrey',
  'Mitcham': 'Surrey',
  'Morden': 'Surrey',
  'Sutton': 'Surrey',
  'Cheam': 'Surrey',
  'Ewell': 'Surrey',
  'Stoneleigh': 'Surrey',
  'Chessington': 'Surrey',
  'Claygate': 'Surrey',
  'Cobham': 'Surrey',
  'Oxshott': 'Surrey',
  'Stoke D\'Abernon': 'Surrey',
  'Fetcham': 'Surrey',
  'Bookham': 'Surrey',
  'Effingham': 'Surrey',
  'Horsley': 'Surrey',
  'Ockham': 'Surrey',
  'Ripley': 'Surrey',
  'Send': 'Surrey',
  'Pyrford': 'Surrey',
  'Wisley': 'Surrey',
  'Byfleet': 'Surrey',
  'West Byfleet': 'Surrey',
  'Brooklands': 'Surrey',
  'Hersham': 'Surrey',
  'Molesey': 'Surrey',
  'Thames Ditton': 'Surrey',
  'Long Ditton': 'Surrey',
  'Hinchley Wood': 'Surrey',
  'Tolworth': 'Surrey',
  'Hook': 'Surrey',
  'Chessington': 'Surrey',
  'Malden Rushett': 'Surrey',
  'Ashtead': 'Surrey',
  'Tadworth': 'Surrey',
  'Kingswood': 'Surrey',
  'Burgh Heath': 'Surrey',
  'Banstead': 'Surrey',
  'Chipstead': 'Surrey',
  'Coulsdon': 'Surrey',
  'Purley': 'Surrey',
  'Kenley': 'Surrey',
  'Whyteleafe': 'Surrey',
  'Warlingham': 'Surrey',
  'Chelsham': 'Surrey',
  'Farleigh': 'Surrey',
  'Chaldon': 'Surrey',
  'Bletchingley': 'Surrey',
  'Nutfield': 'Surrey',
  'South Nutfield': 'Surrey',
  'Salfords': 'Surrey',
  'Horley': 'Surrey',
  'Charlwood': 'Surrey',
  'Newdigate': 'Surrey',
  'Capel': 'Surrey',
  'Ockley': 'Surrey',
  'Rudgwick': 'Surrey',
  'Alfold': 'Surrey',
  'Loxwood': 'Surrey',
  'Plaistow': 'Surrey',
  'Kirdford': 'Surrey',
  'Wisborough Green': 'Surrey',
  'Billingshurst': 'Surrey',
  'Slinfold': 'Surrey',
  'Itchingfield': 'Surrey',
  'Barns Green': 'Surrey',
  'Southwater': 'Surrey',
  'Christ\'s Hospital': 'Surrey',
  'Horsham': 'Surrey',
  'Broadbridge Heath': 'Surrey',
  'Warnham': 'Surrey',
  'Rusper': 'Surrey',
  'Faygate': 'Surrey',
  'Colgate': 'Surrey',
  'Pease Pottage': 'Surrey',
  'Handcross': 'Surrey',
  'Slaugham': 'Surrey',
  'Ansty': 'Surrey',
  'Cuckfield': 'Surrey',
  'Haywards Heath': 'Surrey',
  'Lindfield': 'Surrey',
  'Ardingly': 'Surrey',
  'Turners Hill': 'Surrey',
  'Crawley Down': 'Surrey',
  'Copthorne': 'Surrey',
  'Worth': 'Surrey',
  'Pound Hill': 'Surrey',
  'Three Bridges': 'Surrey',
  'Crawley': 'Surrey',
  'Ifield': 'Surrey',
  'Gossops Green': 'Surrey',
  'Bewbush': 'Surrey',
  'Broadfield': 'Surrey',
  'Tilgate': 'Surrey',
  'Furnace Green': 'Surrey',
  'Southgate': 'Surrey',
  'Langley Green': 'Surrey',
  'West Green': 'Surrey',
  'Northgate': 'Surrey',
  'Maidenbower': 'Surrey',

  // Scotland - Dumfries and Galloway
  'Newton Stewart': 'Dumfries and Galloway',
  'Stranraer': 'Dumfries and Galloway',
  'Wigtown': 'Dumfries and Galloway',
  'Whithorn': 'Dumfries and Galloway',
  'Glenluce': 'Dumfries and Galloway',
  'Castle Kennedy': 'Dumfries and Galloway',
  'Portpatrick': 'Dumfries and Galloway',
  'Kirkcolm': 'Dumfries and Galloway',
  'Leswalt': 'Dumfries and Galloway',
  'Stoneykirk': 'Dumfries and Galloway',
  'Sandhead': 'Dumfries and Galloway',
  'Ardwell': 'Dumfries and Galloway',
  'Drummore': 'Dumfries and Galloway',
  'Mull of Galloway': 'Dumfries and Galloway',
  'Port Logan': 'Dumfries and Galloway',
  'Monreith': 'Dumfries and Galloway',
  'Port William': 'Dumfries and Galloway',
  'Bladnoch': 'Dumfries and Galloway',
  'Kirkinner': 'Dumfries and Galloway',
  'Sorbie': 'Dumfries and Galloway',
  'Garlieston': 'Dumfries and Galloway',
  'Whauphill': 'Dumfries and Galloway',
  'Millisle': 'Dumfries and Galloway',
  'Elrig': 'Dumfries and Galloway',
  'Kirkcowan': 'Dumfries and Galloway',
  'New Luce': 'Dumfries and Galloway',
  'Challoch': 'Dumfries and Galloway',
  'Dunragit': 'Dumfries and Galloway',
  'Glenluce': 'Dumfries and Galloway',
  'Castle Kennedy': 'Dumfries and Galloway',
  'Inch': 'Dumfries and Galloway',
  'Lochans': 'Dumfries and Galloway',
  'Stoneykirk': 'Dumfries and Galloway',
  'Sandhead': 'Dumfries and Galloway',
  'Kirkcolm': 'Dumfries and Galloway',
  'Leswalt': 'Dumfries and Galloway',
  'Portpatrick': 'Dumfries and Galloway',
  'Lochans': 'Dumfries and Galloway',
  'Black Head': 'Dumfries and Galloway',
  'Cairnryan': 'Dumfries and Galloway',
  'Wig Bay': 'Dumfries and Galloway',
  'Kirkcolm': 'Dumfries and Galloway',
  'Leswalt': 'Dumfries and Galloway',
  'Stranraer': 'Dumfries and Galloway',
  'Castle Kennedy': 'Dumfries and Galloway',
  'Inch': 'Dumfries and Galloway',
  'Lochans': 'Dumfries and Galloway',
  'Glenluce': 'Dumfries and Galloway',
  'Dunragit': 'Dumfries and Galloway',
  'Challoch': 'Dumfries and Galloway',
  'New Luce': 'Dumfries and Galloway',
  'Cross Michael': 'Dumfries and Galloway',
  'Kirkcowan': 'Dumfries and Galloway',
  'Whauphill': 'Dumfries and Galloway',
  'Sorbie': 'Dumfries and Galloway',
  'Millisle': 'Dumfries and Galloway',
  'Garlieston': 'Dumfries and Galloway',
  'Kirkinner': 'Dumfries and Galloway',
  'Bladnoch': 'Dumfries and Galloway',
  'Wigtown': 'Dumfries and Galloway',
  'Creetown': 'Dumfries and Galloway',
  'Gatehouse of Fleet': 'Dumfries and Galloway',
  'Castle Douglas': 'Dumfries and Galloway',
  'Kirkcudbright': 'Dumfries and Galloway',
  'Dalbeattie': 'Dumfries and Galloway',
  'New Abbey': 'Dumfries and Galloway',
  'Dumfries': 'Dumfries and Galloway',
  'Thornhill': 'Dumfries and Galloway',
  'Sanquhar': 'Dumfries and Galloway',
  'Kirkconnel': 'Dumfries and Galloway',
  'New Cumnock': 'Dumfries and Galloway',
  'Cumnock': 'Dumfries and Galloway',
  'Lugar': 'Dumfries and Galloway',
  'Ochiltree': 'Dumfries and Galloway',
  'Drongan': 'Dumfries and Galloway',
  'Coylton': 'Dumfries and Galloway',
  'Annbank': 'Dumfries and Galloway',
  'Tarbolton': 'Dumfries and Galloway',
  'Mauchline': 'Dumfries and Galloway',
  'Catrine': 'Dumfries and Galloway',
  'Sorn': 'Dumfries and Galloway',
  'Muirkirk': 'Dumfries and Galloway',
  'Glenbuck': 'Dumfries and Galloway',
  'Douglas': 'Dumfries and Galloway',
  'Leadhills': 'Dumfries and Galloway',
  'Wanlockhead': 'Dumfries and Galloway',
  'Mennock': 'Dumfries and Galloway',
  'Enterkinfoot': 'Dumfries and Galloway',
  'Carronbridge': 'Dumfries and Galloway',
  'Thornhill': 'Dumfries and Galloway',
  'Penpont': 'Dumfries and Galloway',
  'Tynron': 'Dumfries and Galloway',
  'Moniaive': 'Dumfries and Galloway',
  'Dunscore': 'Dumfries and Galloway',
  'Corsock': 'Dumfries and Galloway',
  'Crossmichael': 'Dumfries and Galloway',
  'Parton': 'Dumfries and Galloway',
  'Balmaclellan': 'Dumfries and Galloway',
  'New Galloway': 'Dumfries and Galloway',
  'St John\'s Town of Dalry': 'Dumfries and Galloway',
  'Carsphairn': 'Dumfries and Galloway',
  'Dalmellington': 'Dumfries and Galloway',
  'Straiton': 'Dumfries and Galloway',
  'Kirkmichael': 'Dumfries and Galloway',
  'Crosshill': 'Dumfries and Galloway',
  'Dailly': 'Dumfries and Galloway',
  'Old Dailly': 'Dumfries and Galloway',
  'Girvan': 'Dumfries and Galloway',
  'Turnberry': 'Dumfries and Galloway',
  'Maidens': 'Dumfries and Galloway',
  'Kirkoswald': 'Dumfries and Galloway',
  'Maybole': 'Dumfries and Galloway',
  'Crossraguel': 'Dumfries and Galloway',
  'Kirkmichael': 'Dumfries and Galloway',
  'Straiton': 'Dumfries and Galloway',
  'Barr': 'Dumfries and Galloway',
  'Pinwherry': 'Dumfries and Galloway',
  'Barrhill': 'Dumfries and Galloway',
  'Colmonell': 'Dumfries and Galloway',
  'Ballantrae': 'Dumfries and Galloway',
  'Lendalfoot': 'Dumfries and Galloway',
  'Pinmore': 'Dumfries and Galloway',
  'Pinwherry': 'Dumfries and Galloway',
  'Barr': 'Dumfries and Galloway',
  'Straiton': 'Dumfries and Galloway',
  'Kirkmichael': 'Dumfries and Galloway',
  'Crosshill': 'Dumfries and Galloway',
  'Dailly': 'Dumfries and Galloway',
  'Old Dailly': 'Dumfries and Galloway',
  'Girvan': 'Dumfries and Galloway',
  'Turnberry': 'Dumfries and Galloway',
  'Maidens': 'Dumfries and Galloway',
  'Kirkoswald': 'Dumfries and Galloway',
  'Maybole': 'Dumfries and Galloway',
  'Crossraguel': 'Dumfries and Galloway',
  'Kirkmichael': 'Dumfries and Galloway',
  'Straiton': 'Dumfries and Galloway',
  'Dalmellington': 'Dumfries and Galloway',
  'Carsphairn': 'Dumfries and Galloway',
  'St John\'s Town of Dalry': 'Dumfries and Galloway',
  'New Galloway': 'Dumfries and Galloway',
  'Balmaclellan': 'Dumfries and Galloway',
  'Parton': 'Dumfries and Galloway',
  'Crossmichael': 'Dumfries and Galloway',
  'Corsock': 'Dumfries and Galloway',
  'Dunscore': 'Dumfries and Galloway',
  'Moniaive': 'Dumfries and Galloway',
  'Tynron': 'Dumfries and Galloway',
  'Penpont': 'Dumfries and Galloway',
  'Thornhill': 'Dumfries and Galloway',
  'Carronbridge': 'Dumfries and Galloway',
  'Enterkinfoot': 'Dumfries and Galloway',
  'Mennock': 'Dumfries and Galloway',
  'Wanlockhead': 'Dumfries and Galloway',
  'Leadhills': 'Dumfries and Galloway',
  'Douglas': 'Dumfries and Galloway',
  'Glenbuck': 'Dumfries and Galloway',
  'Muirkirk': 'Dumfries and Galloway',
  'Sorn': 'Dumfries and Galloway',
  'Catrine': 'Dumfries and Galloway',
  'Mauchline': 'Dumfries and Galloway',
  'Tarbolton': 'Dumfries and Galloway',
  'Annbank': 'Dumfries and Galloway',
  'Coylton': 'Dumfries and Galloway',
  'Drongan': 'Dumfries and Galloway',
  'Ochiltree': 'Dumfries and Galloway',
  'Lugar': 'Dumfries and Galloway',
  'Cumnock': 'Dumfries and Galloway',
  'New Cumnock': 'Dumfries and Galloway',
  'Kirkconnel': 'Dumfries and Galloway',
  'Sanquhar': 'Dumfries and Galloway',
  'Thornhill': 'Dumfries and Galloway',
  'Dumfries': 'Dumfries and Galloway',
  'New Abbey': 'Dumfries and Galloway',
  'Dalbeattie': 'Dumfries and Galloway',
  'Kirkcudbright': 'Dumfries and Galloway',
  'Castle Douglas': 'Dumfries and Galloway',
  'Gatehouse of Fleet': 'Dumfries and Galloway',
  'Creetown': 'Dumfries and Galloway',
  'Wigtown': 'Dumfries and Galloway',
  'Bladnoch': 'Dumfries and Galloway',
  'Kirkinner': 'Dumfries and Galloway',
  'Garlieston': 'Dumfries and Galloway',
  'Millisle': 'Dumfries and Galloway',
  'Sorbie': 'Dumfries and Galloway',
  'Whauphill': 'Dumfries and Galloway',
  'Kirkcowan': 'Dumfries and Galloway',
  'Cross Michael': 'Dumfries and Galloway',
  'New Luce': 'Dumfries and Galloway',
  'Challoch': 'Dumfries and Galloway',
  'Dunragit': 'Dumfries and Galloway',
  'Glenluce': 'Dumfries and Galloway',
  'Lochans': 'Dumfries and Galloway',
  'Inch': 'Dumfries and Galloway',
  'Castle Kennedy': 'Dumfries and Galloway',
  'Stranraer': 'Dumfries and Galloway',
  'Leswalt': 'Dumfries and Galloway',
  'Kirkcolm': 'Dumfries and Galloway',
  'Wig Bay': 'Dumfries and Galloway',
  'Cairnryan': 'Dumfries and Galloway',
  'Black Head': 'Dumfries and Galloway',
  'Lochans': 'Dumfries and Galloway',
  'Portpatrick': 'Dumfries and Galloway',
  'Leswalt': 'Dumfries and Galloway',
  'Kirkcolm': 'Dumfries and Galloway',
  'Sandhead': 'Dumfries and Galloway',
  'Stoneykirk': 'Dumfries and Galloway',
  'Lochans': 'Dumfries and Galloway',
  'Inch': 'Dumfries and Galloway',
  'Castle Kennedy': 'Dumfries and Galloway',
  'Glenluce': 'Dumfries and Galloway',
  'Challoch': 'Dumfries and Galloway',
  'Dunragit': 'Dumfries and Galloway',
  'New Luce': 'Dumfries and Galloway',
  'Kirkcowan': 'Dumfries and Galloway',
  'Elrig': 'Dumfries and Galloway',
  'Millisle': 'Dumfries and Galloway',
  'Whauphill': 'Dumfries and Galloway',
  'Garlieston': 'Dumfries and Galloway',
  'Sorbie': 'Dumfries and Galloway',
  'Kirkinner': 'Dumfries and Galloway',
  'Bladnoch': 'Dumfries and Galloway',
  'Port William': 'Dumfries and Galloway',
  'Monreith': 'Dumfries and Galloway',
  'Port Logan': 'Dumfries and Galloway',
  'Mull of Galloway': 'Dumfries and Galloway',
  'Drummore': 'Dumfries and Galloway',
  'Ardwell': 'Dumfries and Galloway',
  'Sandhead': 'Dumfries and Galloway',
  'Stoneykirk': 'Dumfries and Galloway',
  'Leswalt': 'Dumfries and Galloway',
  'Kirkcolm': 'Dumfries and Galloway',
  'Portpatrick': 'Dumfries and Galloway',
  'Castle Kennedy': 'Dumfries and Galloway',
  'Glenluce': 'Dumfries and Galloway',
  'Whithorn': 'Dumfries and Galloway',
  'Wigtown': 'Dumfries and Galloway',
  'Stranraer': 'Dumfries and Galloway',
  'Newton Stewart': 'Dumfries and Galloway'
}

async function updateCountyMappings() {
  console.log('ðŸ”„ Updating county mappings for "Other" category cities...\n')

  let totalUpdated = 0
  let notMappedCities = []

  for (const [city, county] of Object.entries(cityToCountyMapping)) {
    try {
      const { data: existingButchers, error: fetchError } = await supabase
        .from('butchers')
        .select('id')
        .eq('city', city)
        .eq('county', 'Other')

      if (fetchError) {
        console.error(`Error fetching butchers for ${city}:`, fetchError.message)
        continue
      }

      if (existingButchers && existingButchers.length > 0) {
        const { error: updateError } = await supabase
          .from('butchers')
          .update({ county: county })
          .eq('city', city)
          .eq('county', 'Other')

        if (updateError) {
          console.error(`Error updating ${city} to ${county}:`, updateError.message)
        } else {
          console.log(`âœ… Updated ${existingButchers.length} butcher(s) in ${city} to ${county}`)
          totalUpdated += existingButchers.length
        }
      }
    } catch (error) {
      console.error(`Exception updating ${city}:`, error.message)
    }

    // Small delay to avoid overwhelming the database
    await new Promise(resolve => setTimeout(resolve, 50))
  }

  // Check for any remaining cities in Other that we didn't map
  const { data: remainingOther, error: remainingError } = await supabase
    .from('butchers')
    .select('city, count(*)')
    .eq('county', 'Other')

  if (!remainingError && remainingOther) {
    const remainingCities = {}
    remainingOther.forEach(butcher => {
      if (remainingCities[butcher.city]) {
        remainingCities[butcher.city]++
      } else {
        remainingCities[butcher.city] = 1
      }
    })

    const unmappedCities = Object.keys(remainingCities).filter(city => !cityToCountyMapping[city])

    if (unmappedCities.length > 0) {
      console.log('\nâš ï¸ Cities still in "Other" category that need manual mapping:')
      unmappedCities.forEach(city => {
        console.log(`   - ${city}: ${remainingCities[city]} butcher(s)`)
      })
    }
  }

  console.log(`\nâœ… COUNTY MAPPING UPDATE COMPLETE:`)
  console.log(`ðŸ“Š Total butchers updated: ${totalUpdated}`)

  // Final count check
  const { count: finalOtherCount } = await supabase
    .from('butchers')
    .select('*', { count: 'exact', head: true })
    .eq('county', 'Other')

  console.log(`ðŸ“ˆ Remaining butchers in "Other": ${finalOtherCount}`)

  // Show updated county distribution
  console.log('\nðŸ“ˆ Updated county distribution (top 10):')
  const { data: updatedCounties } = await supabase
    .from('butchers')
    .select('county')
    .not('county', 'is', null)

  if (updatedCounties) {
    const countyCounts = {}
    updatedCounties.forEach(butcher => {
      countyCounts[butcher.county] = (countyCounts[butcher.county] || 0) + 1
    })

    const sortedCounties = Object.entries(countyCounts)
      .sort(([,a], [,b]) => b - a)
      .slice(0, 10)

    sortedCounties.forEach(([county, count]) => {
      console.log(`   ${county}: ${count} butchers`)
    })
  }
}

updateCountyMappings()